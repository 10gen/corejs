<% processArgs("opts");
   opts = opts || {};
   var login = User.findMyLocation();
   // FIXME: this form dynamically recomputes itself to do checks and stuff
   // login_user -> username, etc. If JS is disabled, registration is impossible
%>
<div id="register">


  <form method="post" action="<%= login %>/register" onSubmit="return checkRegister( this )" class="edit register" id="register_form">

    <fieldset class="edit register">
    <legend>Register</legend>
    <table>
    <tr>
        <td><label for="login_user">Username</label></td>
        <td><input name="login_user" class="text" value="<%= opts.username || "" %>" onblur="blurUsername()"></td>
    </tr>

    <tr>
        <td><label for="login_pass1">Password</label></td>
        <td><input type="password" name="login_pass1" class="text"></td>
    </tr>

    <tr>
        <td><label for="login_pass2">Password Again</label></td>
        <td><input type="password" name="login_pass2" class="text"></td>
    </tr>
    <tr>
        <td><label for="login_firstname">First name (optional)</label></td>
        <td><input name="login_firstname" class="text" value="<%= opts.firstname || "" %>"></td>
    </tr>

    <tr>
        <td><label for="login_lastname">Last name (optional)</label></td>
        <td><input name="login_lastname" class="text" value="<%= opts.lastname || "" %>"></td>
    </tr>

    <tr>
        <td><label for="login_nickname">Display name</label></td>
        <td><input name="login_nickname" class="text" value="<%= opts.nickname || "" %>"></td>
    </tr>

    <tr>
        <td><label for="login_email">Email</label></td>
        <td><input name="login_email" class="text" value="<%= opts.email || "" %>"></td>
    </tr>

    <tr>
        <td><label for="login_url">URL (optional)</label></td>
        <td><input name="login_url" class="text" value="<%= opts.url || "" %>"></td>
    </tr>

    <% if(User.config.useCaptcha){ %>
    <tr id="comments-open-captcha">
        <td><label>&nbsp;</label></td>
        <td><img src="NOCDN<%= login %>/captchaIMG" id="captcha"/></td>
    </tr>
    
    <tr>
        <td></td>
        <td>
            <span class="small">Type the characters you see in the picture above (just to make sure you&apos;re a human).</span>
            <input name="login_captcha" class="text">
        </td>
    </tr>
    <% } %>

    <tr>
        <td></td>
        <td><input type="submit" value="Register" class="button" style="">
            <% if (opts.to) { %><input type="hidden" name="login_to" value="<%= opts.to %>"/><% } %>
        </td>
    </tr>
    </table>
    </fieldset>
  </form>

</div>
<% head.push( "<script src='/~~/ui/js/common.js'></script>" ); %>
<script src="/~~/user/assets/processRegister.jxp" type="text/javascript"></script>
